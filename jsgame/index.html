<!DOCTYPE html> 
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS Game</title>

    <style>
        body {
            font-family: system-ui, sans-serif;
            max-width: 600px;
            margin: 40px auto;
            text-align: center;
        }
        input {
            padding: 3px;
            margin: 6px;
            font-size: 1rem;
            width: 80px;
        }
        button, input[type=button] {
            padding: 6px 12px;
            font-size: 1rem;
            margin: 5px;
            cursor: pointer;
        }
        #message {
            margin-top: 15px;
            font-weight: bold;
            transition: 0.2s;
        }
        #history {
            margin-top: 10px;
            font-size: 0.9rem;
            color: #555;
        }
        #history span {
            display: inline-block;
            margin: 2px 4px;
            padding: 2px 6px;
            border-radius: 4px;
            background-color: #eee;
        }
    </style>
</head>
<body>
    <h1> Welcome to the JS Game! </h1>

    <!-- Input pro maxim√°ln√≠ ƒç√≠slo -->
    <p>
        Maxim√°ln√≠ ƒç√≠slo:
        <input id="maxRange" type="number" value="20" min="5" max="500">
    </p>

    <p id="message">H√°dej ƒç√≠slo od 1 do 20</p>
       
    <input id="guess" type="number" name="guess">
    <input id="guessBtn" type="button" value="Zkus">
    <br>
    <input id="newGameBtn" type="button" value="Nova hra" onclick="newGame()">

    <div id="history">Tipy: </div>

    <p>Poƒçet pokus≈Ø <span id="attempts">0</span>.</p>
        
    <script>
        let secretNumber;
        let attempts;
        const maxAttempts = 10;
        let maxRange = 20;
        let inactivityTimer;
        const guesses = []; // historie tip≈Ø

        const attemptsEl = document.getElementById('attempts');
        const messageEl = document.getElementById('message');
        const inputEl = document.getElementById('guess');
        const maxRangeEl = document.getElementById('maxRange');
        const historyEl = document.getElementById('history');

        // -----------------------------
        // Funkce pro start nov√© hry
        // -----------------------------
        function newGame() {
            resetTimer();

            maxRange = Number(maxRangeEl.value);
            if (maxRange < 5) maxRange = 5;
            if (maxRange > 500) maxRange = 500;
            maxRangeEl.value = maxRange;

            secretNumber = Math.floor(Math.random() * maxRange) + 1;

            attempts = 0;
            attemptsEl.textContent = attempts;

            messageEl.textContent = `H√°dej ƒç√≠slo od 1 do ${maxRange}`;
            messageEl.style.color = 'black';

            inputEl.disabled = false;
            inputEl.value = '';

            // vyƒçistit historii tip≈Ø
            guesses.length = 0;
            updateHistory();

            console.log('--- NOV√Å HRA ---');
            console.log('Max rozsah:', maxRange);
            console.log('Tajn√© ƒç√≠slo:', secretNumber);
        }

        // -----------------------------
        // Funkce pro konec hry
        // -----------------------------
        function endGame(text, color) {
            messageEl.textContent = text;
            messageEl.style.color = color;
            inputEl.disabled = true;
            console.log(text);
        }

        // -----------------------------
        // Kontrola tip≈Ø hr√°ƒçe
        // -----------------------------
        function checkGuess() {
            if (inputEl.disabled) return;

            resetTimer();

            attempts++;
            attemptsEl.textContent = attempts;

            let guess = Number(inputEl.value);
            console.log("Tip hr√°ƒçe:", guess);

            if (!guess) {
                messageEl.textContent = "Zadej ƒç√≠slo!";
                return;
            }

            // ulo≈æit tip do historie
            guesses.push(guess);
            updateHistory();

            if (attempts >= maxAttempts && guess !== secretNumber) {
                endGame(`Konec hry! Do≈°ly ti pokusy! Spr√°vn√© ƒç√≠slo bylo ${secretNumber}.`, "red");
                return;
            }

            if (guess === secretNumber) {
                endGame("Vyhr√°l jsi! üéâ", "green");
                return;
            }

            if (guess < secretNumber) {
                messageEl.textContent = "Zkus vƒõt≈°√≠ ƒç√≠slo!";
            } else {
                messageEl.textContent = "Zkus men≈°√≠ ƒç√≠slo!";
            }
        }

        // -----------------------------
        // Aktualizace historie tip≈Ø
        // -----------------------------
        function updateHistory() {
            historyEl.innerHTML = 'Tipy: ';
            guesses.forEach(g => {
                const span = document.createElement('span');
                span.textContent = g;
                historyEl.appendChild(span);
            });
        }

        // -----------------------------
        // Omezen√≠ vstupu hr√°ƒçe na rozsah 1‚ÄìmaxRange
        // -----------------------------
        function limitInput() {
            let value = Number(inputEl.value);

            if (value < 1) {
                console.log("ƒå√≠slo nesm√≠ b√Ωt men≈°√≠ ne≈æ 1, opravuji.");
                inputEl.value = 1;
            }
            if (value > maxRange) {
                console.log(`ƒå√≠slo nesm√≠ b√Ωt vƒõt≈°√≠ ne≈æ ${maxRange}, opravuji.`);
                inputEl.value = maxRange;
            }
        }

        // -----------------------------
        // Inactivity alert (jen pokud hr√°ƒç nic nedƒõl√°)
        // -----------------------------
        function resetTimer() {
            clearTimeout(inactivityTimer);
            inactivityTimer = setTimeout(() => {
                alert('Pospƒõ≈°te si, hra bƒõ≈æ√≠!');
            }, 10000); // 10 sekund neƒçinnosti
        }

        // -----------------------------
        // Event listenery
        // -----------------------------
        document.getElementById('guessBtn').addEventListener('click', checkGuess);
        inputEl.addEventListener("input", limitInput);
        inputEl.addEventListener('keydown', function(e) {
            if (e.key === 'Enter') {
                checkGuess();
                e.srcElement.value = '';
            }
        });

        // start hry p≈ôi naƒçten√≠ str√°nky
        newGame();
    </script>
</body>
</html>
